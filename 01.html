<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Amos Jerbi</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="assets/images/favicon.png" />
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Montserrat:300,600,800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Questrial&display=swap" rel="stylesheet">
    
    <!-- CSS -->
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet" href="assets/css/aos.css">
    <link rel="stylesheet" href="assets/font/socialfont.css">
    
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Add these to your head section -->
    <link rel="stylesheet" href="assets/css/glide.css">
    <link rel="stylesheet" href="assets/css/lightgallery.css">
</head>

<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container-nav">
            <div class="brand">
                <a href="index.html"> <img src="assets/images/amoslogo.svg" alt="logo"> </a>
            </div>
            <ul class="menu-end">
                <li><a href="index.html" class="menu-item">Home</a></li>
                <li><a href="gallery.html" class="menu-item">Gallery</a></li>
                <li><a href="#about-me-modal" rel="noopener" class="button_prime">About</a></li>
            </ul>
        </div>
    </nav>

    <!-- Main Content -->
    <main>
        <section class="section is-small">
            <div class="container">
                <div class="grid12 is-small">
                    <div class="column_left">
                        <h1 class="is-bold">Instagram Feed</h1>
                        <p>Check out my latest work</p>
                    </div>
                </div>
                <!-- Instagram Carousel -->
                <div id="instagram-carousel" class="glide">
                    <div class="glide__track" data-glide-el="track">
                        <ul class="glide__slides">
                            <!-- Slides will be added here dynamically -->
                            <div class="loading">Loading Instagram posts...</div>
                        </ul>
                    </div>
                    <div class="glide__bullets" data-glide-el="controls[nav]">
                        <!-- Bullets will be added dynamically -->
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer id="footer" class="section has-background-denim">
        <div class="section">
            <div class="container">
                <div class="footer_grid">
                    <div class="footer_links_col1">
                        <div class="footer_logo">
                            <img src="assets/images/amoslogo.svg" alt="logo">
                        </div>
                        <h6>Â© 2024 Amos Jerbi. All rights reserved.</h6>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Modal -->
    <div class="modal-container" id="about-me-modal">
        <div class="modal">
            <a href="#" class="modal__close demo-close">
                <svg class="" viewBox="0 0 24 24">
                    <path d="M6.41900105,6.41900105 L17.5809989,17.5809989 M6.41900105,17.5809989 L17.5809989,6.41900105" stroke="#fff" stroke-width="3.60000014" stroke-linecap="round"></path>
                </svg>
            </a>
            <div class="is-center2">
                <h2 class="is-bold">Product Designer</h2>
                <h5 class="is-bold">BASED IN TEL AVIV</h5>
                <br>
                <p>Hi, I'm Amos a father of two lovely children, passionate towards tech & embrace new challenges whenever they come.</p>
                <br>
                <img src="assets/images/about_dialog.png" class="modal-img">
            </div>
        </div>
        <a href="#" class="modal-bg"></a>
    </div>

    <!-- JS Links -->
    <script src="assets/css/analytics.js"></script>
    <script src="assets/css/toggle.js"></script>
    <script src="assets/css/aos.js"></script>
    <script src="assets/css/main.js"></script>

    <!-- Add Glide.js before other scripts -->
    <script src="assets/css/glide.js"></script>
    <!-- Add this before closing body tag, after other scripts -->
    <script>
    const instagramToken = 'IGAANOMSEaVZCVBZAE5jQ25aQ2kxUC1mcUwtbGRkWFBaUVFTZAm9aZA1Raa3M2MWt1WUMycU95N2c1V0ZA0dTBpcDFJNkFjZAEJzU1N5Rk5VNHBqWXktWTlaOUI2UHlqOUJJS3U3ZAjcta1IwaG1WamNzc2dWb0JibTlqc0M4bmdsdmw1YwZDZD';
    const postCount = 9; // Number of posts to show in carousel

    async function loadInstagramCarousel() {
        const slides = document.querySelector('.glide__slides');
        const bullets = document.querySelector('.glide__bullets');
        
        if (!slides) return;

        try {
            const response = await fetch(
                `https://graph.instagram.com/me/media?fields=id,caption,media_type,media_url,permalink,timestamp&access_token=${instagramToken}&limit=${postCount}`
            );
            
            console.log('API Response:', response);
            
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            
            const data = await response.json();
            console.log('Instagram Data:', data);

            slides.innerHTML = ''; // Clear loading message

            if (!data.data || data.data.length === 0) {
                slides.innerHTML = '<div class="error">No posts found</div>';
                return;
            }

            // Create slides
            data.data.forEach((post, index) => {
                if (post.media_type === 'IMAGE' || post.media_type === 'CAROUSEL_ALBUM') {
                    // Create slide
                    const slide = document.createElement('li');
                    slide.className = 'glide__slide';
                    
                    // Create image container
                    const imgContainer = document.createElement('div');
                    imgContainer.className = 'carousel-slide';
                    
                    // Create image
                    const img = document.createElement('img');
                    img.src = post.media_url;
                    img.alt = post.caption || 'Instagram post';
                    img.className = 'carousel-image';
                    img.onerror = () => console.error('Image failed to load:', post.media_url);
                    img.onload = () => console.log('Image loaded successfully:', post.media_url);
                    
                    // Create preview caption
                    const caption = document.createElement('div');
                    caption.className = 'carousel-caption';
                    caption.textContent = post.caption ? post.caption.slice(0, 100) + '...' : '';
                    
                    // Append elements
                    imgContainer.appendChild(img);
                    imgContainer.appendChild(caption);
                    slide.appendChild(imgContainer);
                    slides.appendChild(slide);

                    // Create bullet
                    const bullet = document.createElement('div');
                    bullet.className = 'glide__bullet';
                    bullet.setAttribute('data-glide-dir', `=${index}`);
                    bullets.appendChild(bullet);
                }
            });

            // Initialize Glide carousel
            const glide = new Glide('#instagram-carousel', {
                type: 'carousel',
                perView: 3,
                gap: 30,
                autoplay: 3000,
                hoverpause: true,
                breakpoints: {
                    800: {
                        perView: 2
                    },
                    480: {
                        perView: 1
                    }
                }
            });

            console.log('Mounting Glide carousel...');
            glide.mount();
            console.log('Glide carousel mounted');

        } catch (error) {
            console.error('Error:', error);
            slides.innerHTML = `<li class="glide__slide">Unable to load Instagram posts: ${error.message}</li>`;
        }
    }

    // Function to show lightbox for specific image
    function showLightbox(index) {
        const lightboxInstance = window.lgData[document.getElementById('lightgallery-carousel').getAttribute('lg-uid')];
        if (lightboxInstance) {
            lightboxInstance.openGallery(index);
        }
    }

    // Load carousel when page loads
    document.addEventListener('DOMContentLoaded', loadInstagramCarousel);
    </script>

    <!-- Add Glide.js before other scripts -->
    <script src="assets/css/glide.js"></script>
    <script src="assets/css/lightgallery.js"></script>
</body>
</html>
